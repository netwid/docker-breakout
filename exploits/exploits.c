#include <stdio.h>
#include <unistd.h>

#include "exploits.h"
#include "exploits_internal.h"

static int check_docker() {
    if (access("/.dockerenv", F_OK) == 0)
        return 1;
    return 0;
}

int run_exploits() {
    if (!check_docker()) {
        printf("Script must be run inside docker container");
        return 1;
    }
    printf("Starting exploits\n");
    run_CVE_2019_5736();
    run_CVE_2022_0847();
    return 0;
}
